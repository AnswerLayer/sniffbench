# Example Bootstrap Case Specification
# This is a template showing what a test case looks like

id: bootstrap-001
title: "Add error handling to unprotected API calls"
description: |
  Functions that make API calls should handle network errors, timeouts, and
  invalid responses gracefully instead of crashing or propagating exceptions
  to callers without context.

category: error-handling
language: python
difficulty: easy
tags:
  - reliability
  - error-handling
  - api

# The problematic code that agents will be asked to fix
files:
  - path: src/api_client.py
    content: |
      import requests

      def fetch_user(user_id):
          """Fetch user data from API."""
          response = requests.get(f"https://api.example.com/users/{user_id}")
          return response.json()

      def update_user(user_id, data):
          """Update user data via API."""
          response = requests.post(
              f"https://api.example.com/users/{user_id}",
              json=data
          )
          return response.json()

# How we validate the solution
validation:
  type: test_suite
  command: pytest tests/test_api_client.py -v

  # Tests that should pass after agent fixes the code
  tests:
    - name: test_handles_network_error
      description: Should handle network connectivity issues
    - name: test_handles_timeout
      description: Should handle request timeouts
    - name: test_handles_404
      description: Should handle resource not found
    - name: test_handles_500
      description: Should handle server errors
    - name: test_invalid_json
      description: Should handle invalid JSON responses

# What a good solution looks like (for reference, not shown to agent)
solution_hints:
  - Wrap API calls in try-except blocks
  - Handle requests.RequestException for network issues
  - Handle requests.Timeout specifically
  - Check response.status_code before calling .json()
  - Raise custom exceptions with context
  - Consider retry logic for transient failures

# Scoring weights for this specific case (optional, uses defaults if not specified)
scoring:
  correctness: 50  # All tests must pass
  code_quality: 20  # Clean error handling
  safety: 20       # No silent failures
  performance: 5   # Efficient error handling
  maintainability: 5  # Clear error messages
